<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png"><link rel="manifest" href="/manifest.webmanifest"><meta name="application-name" content="VuePress"><meta name="apple-mobile-web-app-title" content="VuePress"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png"><link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#1097e5"><meta name="msapplication-TileColor" content="#1097e5"><meta name="theme-color" content="#1097e5"><title>Kubernetes高可用集群 | DolphinDB云</title><meta name="description" content="DolphinDB在云平台中的使用">
    <link rel="modulepreload" href="/assets/app.0ebc3338.js"><link rel="modulepreload" href="/assets/kubernetes-cluster-ha.html.d7796b96.js"><link rel="modulepreload" href="/assets/kubernetes-cluster-ha.html.183697e6.js"><link rel="prefetch" href="/assets/index.html.f1a80ab5.js"><link rel="prefetch" href="/assets/index.html.0a37422c.js"><link rel="prefetch" href="/assets/index.html.de845478.js"><link rel="prefetch" href="/assets/container-deployment.html.1b60bdea.js"><link rel="prefetch" href="/assets/public-cloud.html.0b0c813a.js"><link rel="prefetch" href="/assets/roadmap.html.6dd2e881.js"><link rel="prefetch" href="/assets/index.html.34b2706f.js"><link rel="prefetch" href="/assets/installer-config.html.41731bcc.js"><link rel="prefetch" href="/assets/index.html.f6b6e557.js"><link rel="prefetch" href="/assets/installer.html.ff1e482d.js"><link rel="prefetch" href="/assets/index.html.a8047cb0.js"><link rel="prefetch" href="/assets/crd-operator.html.42573589.js"><link rel="prefetch" href="/assets/installer-config.html.a299666d.js"><link rel="prefetch" href="/assets/rbac.html.5e6955b5.js"><link rel="prefetch" href="/assets/harbor.html.2782ebf7.js"><link rel="prefetch" href="/assets/helm-chartmuseum.html.5de880fb.js"><link rel="prefetch" href="/assets/helm-push.html.8d0ca042.js"><link rel="prefetch" href="/assets/helm.html.fd009271.js"><link rel="prefetch" href="/assets/kubeadm.html.1621ba6a.js"><link rel="prefetch" href="/assets/kubectl.html.8eb7cf46.js"><link rel="prefetch" href="/assets/crd-operator.html.9a31a5f4.js"><link rel="prefetch" href="/assets/dolphindb-deployment.html.c66d707b.js"><link rel="prefetch" href="/assets/dolphindb-runtime.html.9ef823f1.js"><link rel="prefetch" href="/assets/high-availability.html.13d77745.js"><link rel="prefetch" href="/assets/site-reliability.html.0d48ed20.js"><link rel="prefetch" href="/assets/index.html.ace15598.js"><link rel="prefetch" href="/assets/alibaba-cloud.html.969c3fd8.js"><link rel="prefetch" href="/assets/aws.html.b5e2fbdb.js"><link rel="prefetch" href="/assets/index.html.495c784d.js"><link rel="prefetch" href="/assets/cni-calico.html.c5fb13e4.js"><link rel="prefetch" href="/assets/cni-cilium-ebpf.html.ca5fbbdc.js"><link rel="prefetch" href="/assets/csi-ceph.html.2c7f461b.js"><link rel="prefetch" href="/assets/csi-localpath.html.e2f83bc2.js"><link rel="prefetch" href="/assets/csi-nfs.html.7135a9c8.js"><link rel="prefetch" href="/assets/kubernetes-cluster.html.78a97841.js"><link rel="prefetch" href="/assets/minikube.html.dc451472.js"><link rel="prefetch" href="/assets/index.html.224ee723.js"><link rel="prefetch" href="/assets/configs.html.a809d517.js"><link rel="prefetch" href="/assets/deployment.html.8ea8fda8.js"><link rel="prefetch" href="/assets/index.html.4a89b3df.js"><link rel="prefetch" href="/assets/authority.html.aa67593e.js"><link rel="prefetch" href="/assets/component.html.a819b076.js"><link rel="prefetch" href="/assets/deployment.html.fa280e57.js"><link rel="prefetch" href="/assets/env-config.html.d14a9e09.js"><link rel="prefetch" href="/assets/faq.html.7d1ecbfd.js"><link rel="prefetch" href="/assets/portal.html.a6f42b0c.js"><link rel="prefetch" href="/assets/release.html.9c64928e.js"><link rel="prefetch" href="/assets/404.html.c3e557d0.js"><link rel="prefetch" href="/assets/index.html.fd861e0b.js"><link rel="prefetch" href="/assets/index.html.6b452f92.js"><link rel="prefetch" href="/assets/index.html.4d186d16.js"><link rel="prefetch" href="/assets/container-deployment.html.97ace4d2.js"><link rel="prefetch" href="/assets/public-cloud.html.16abdc87.js"><link rel="prefetch" href="/assets/roadmap.html.768b5671.js"><link rel="prefetch" href="/assets/index.html.d49365a1.js"><link rel="prefetch" href="/assets/installer-config.html.9f20e335.js"><link rel="prefetch" href="/assets/index.html.4ce8d697.js"><link rel="prefetch" href="/assets/installer.html.6e9960a4.js"><link rel="prefetch" href="/assets/index.html.deb55057.js"><link rel="prefetch" href="/assets/crd-operator.html.807c001e.js"><link rel="prefetch" href="/assets/installer-config.html.2a52dd76.js"><link rel="prefetch" href="/assets/rbac.html.805994c2.js"><link rel="prefetch" href="/assets/harbor.html.d252ac7a.js"><link rel="prefetch" href="/assets/helm-chartmuseum.html.ac1ccb39.js"><link rel="prefetch" href="/assets/helm-push.html.fe9848db.js"><link rel="prefetch" href="/assets/helm.html.6bc1398e.js"><link rel="prefetch" href="/assets/kubeadm.html.b02b9cf9.js"><link rel="prefetch" href="/assets/kubectl.html.a71dcbd5.js"><link rel="prefetch" href="/assets/crd-operator.html.d546bae9.js"><link rel="prefetch" href="/assets/dolphindb-deployment.html.bc75f242.js"><link rel="prefetch" href="/assets/dolphindb-runtime.html.060bdba6.js"><link rel="prefetch" href="/assets/high-availability.html.68d348d2.js"><link rel="prefetch" href="/assets/site-reliability.html.3e94eb78.js"><link rel="prefetch" href="/assets/index.html.e2bd0bae.js"><link rel="prefetch" href="/assets/alibaba-cloud.html.807cc30c.js"><link rel="prefetch" href="/assets/aws.html.ea08635b.js"><link rel="prefetch" href="/assets/index.html.916e18d4.js"><link rel="prefetch" href="/assets/cni-calico.html.639bc2be.js"><link rel="prefetch" href="/assets/cni-cilium-ebpf.html.7854307f.js"><link rel="prefetch" href="/assets/csi-ceph.html.68e64302.js"><link rel="prefetch" href="/assets/csi-localpath.html.88a414c1.js"><link rel="prefetch" href="/assets/csi-nfs.html.f6e6c949.js"><link rel="prefetch" href="/assets/kubernetes-cluster.html.56caeec7.js"><link rel="prefetch" href="/assets/minikube.html.73533263.js"><link rel="prefetch" href="/assets/index.html.8659aca5.js"><link rel="prefetch" href="/assets/configs.html.f34588d3.js"><link rel="prefetch" href="/assets/deployment.html.32c62534.js"><link rel="prefetch" href="/assets/index.html.2b13966d.js"><link rel="prefetch" href="/assets/authority.html.8ee35c61.js"><link rel="prefetch" href="/assets/component.html.a9f20a8b.js"><link rel="prefetch" href="/assets/deployment.html.5ca17180.js"><link rel="prefetch" href="/assets/env-config.html.38decef0.js"><link rel="prefetch" href="/assets/faq.html.3dd79a98.js"><link rel="prefetch" href="/assets/portal.html.3348e268.js"><link rel="prefetch" href="/assets/release.html.6b72d9d7.js"><link rel="prefetch" href="/assets/404.html.1cae6a52.js"><link rel="prefetch" href="/assets/NpmBadge.069aeab0.js">
    <link rel="stylesheet" href="/assets/style.2367a7e1.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="切换侧边栏" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/hero.png" alt="DolphinDB云"><span class="site-name can-hide">DolphinDB云</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/zh/guide/" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="教程"><span class="title">教程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="教程"><span class="title">教程</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Docker</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://hub.docker.com/r/dolphindb/dolphindb" rel="noopener noreferrer" target="_blank" aria-label="Dokcer Hub"><!--[--><!--]--> Dokcer Hub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Kubernetes</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/dolphindb-runtime.md" class="" aria-label="DolphinDB运行时"><!--[--><!--]--> DolphinDB运行时 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/dolphindb-deployment.md" class="" aria-label="部署DolphinDB"><!--[--><!--]--> 部署DolphinDB <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/crd-operator.md" class="" aria-label="CRD &amp;&amp; Operator"><!--[--><!--]--> CRD &amp;&amp; Operator <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/high-availability.md" class="" aria-label="高可用方案"><!--[--><!--]--> 高可用方案 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/site-reliability.md" class="" aria-label="运维工具"><!--[--><!--]--> 运维工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/dolphindb-mgr/README.md" class="" aria-label="可视化管理平台"><!--[--><!--]--> 可视化管理平台 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>公有云平台</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/public-cloud/aws.md" class="" aria-label="亚马逊云(AWS)"><!--[--><!--]--> 亚马逊云(AWS) <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/public-cloud/alibaba-cloud.md" class="" aria-label="阿里云"><!--[--><!--]--> 阿里云 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="参考"><span class="title">参考</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="参考"><span class="title">参考</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>容器编排</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/reference/docker/README.md" class="" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/kubernetes/README.md" class="" aria-label="Kubernetes"><!--[--><!--]--> Kubernetes <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/docker-compose/README.md" class="" aria-label="Docker Compose"><!--[--><!--]--> Docker Compose <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>常用工具</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/kubeadm.html" class="" aria-label="Kubeadm工具"><!--[--><!--]--> Kubeadm工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/kubectl.html" class="" aria-label="Kubectl工具"><!--[--><!--]--> Kubectl工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/helm.html" class="" aria-label="Helm工具"><!--[--><!--]--> Helm工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/helm-push.html" class="" aria-label="Helm Push插件"><!--[--><!--]--> Helm Push插件 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/helm-chartmuseum.html" class="" aria-label="Chart仓库"><!--[--><!--]--> Chart仓库 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/harbor.html" class="" aria-label="Harbor仓库"><!--[--><!--]--> Harbor仓库 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>DolphinDB</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB 官网"><!--[--><!--]--> DolphinDB 官网 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>DolphinDB 稳定版</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/130/index.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB 稳定版手册"><!--[--><!--]--> DolphinDB 稳定版手册 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/130/DatabaseandDistributedComputing/Configuration/StandaloneMode.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB 稳定版配置"><!--[--><!--]--> DolphinDB 稳定版配置 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/130/DatabaseandDistributedComputing/Configuration/ClusterMode.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB 稳定版集群配置"><!--[--><!--]--> DolphinDB 稳定版集群配置 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>DolphinDB Beta版</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/200/index.html#" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB Beta版手册"><!--[--><!--]--> DolphinDB Beta版手册 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/200/DatabaseandDistributedComputing/Configuration/StandaloneMode.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB Beta版配置"><!--[--><!--]--> DolphinDB Beta版配置 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/200/DatabaseandDistributedComputing/Configuration/ClusterMode.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB Beta版集群配置"><!--[--><!--]--> DolphinDB Beta版集群配置 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/en/" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/dolphindb/dolphindb-k8s/blob/master/README_CN.md" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="切换颜色模式"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/zh/guide/" class="" aria-label="指南"><!--[--><!--]--> 指南 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="教程"><span class="title">教程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="教程"><span class="title">教程</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Docker</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://hub.docker.com/r/dolphindb/dolphindb" rel="noopener noreferrer" target="_blank" aria-label="Dokcer Hub"><!--[--><!--]--> Dokcer Hub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Kubernetes</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/dolphindb-runtime.md" class="" aria-label="DolphinDB运行时"><!--[--><!--]--> DolphinDB运行时 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/dolphindb-deployment.md" class="" aria-label="部署DolphinDB"><!--[--><!--]--> 部署DolphinDB <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/crd-operator.md" class="" aria-label="CRD &amp;&amp; Operator"><!--[--><!--]--> CRD &amp;&amp; Operator <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/high-availability.md" class="" aria-label="高可用方案"><!--[--><!--]--> 高可用方案 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/site-reliability.md" class="" aria-label="运维工具"><!--[--><!--]--> 运维工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/kubernetes/dolphindb-mgr/README.md" class="" aria-label="可视化管理平台"><!--[--><!--]--> 可视化管理平台 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>公有云平台</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/public-cloud/aws.md" class="" aria-label="亚马逊云(AWS)"><!--[--><!--]--> 亚马逊云(AWS) <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/tutorial/public-cloud/alibaba-cloud.md" class="" aria-label="阿里云"><!--[--><!--]--> 阿里云 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="参考"><span class="title">参考</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="参考"><span class="title">参考</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>容器编排</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/reference/docker/README.md" class="" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/kubernetes/README.md" class="" aria-label="Kubernetes"><!--[--><!--]--> Kubernetes <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/docker-compose/README.md" class="" aria-label="Docker Compose"><!--[--><!--]--> Docker Compose <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>常用工具</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/kubeadm.html" class="" aria-label="Kubeadm工具"><!--[--><!--]--> Kubeadm工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/kubectl.html" class="" aria-label="Kubectl工具"><!--[--><!--]--> Kubectl工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/helm.html" class="" aria-label="Helm工具"><!--[--><!--]--> Helm工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/helm-push.html" class="" aria-label="Helm Push插件"><!--[--><!--]--> Helm Push插件 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/helm-chartmuseum.html" class="" aria-label="Chart仓库"><!--[--><!--]--> Chart仓库 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/zh/reference/tools/harbor.html" class="" aria-label="Harbor仓库"><!--[--><!--]--> Harbor仓库 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="了解更多"><span class="title">了解更多</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>DolphinDB</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB 官网"><!--[--><!--]--> DolphinDB 官网 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>DolphinDB 稳定版</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/130/index.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB 稳定版手册"><!--[--><!--]--> DolphinDB 稳定版手册 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/130/DatabaseandDistributedComputing/Configuration/StandaloneMode.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB 稳定版配置"><!--[--><!--]--> DolphinDB 稳定版配置 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/130/DatabaseandDistributedComputing/Configuration/ClusterMode.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB 稳定版集群配置"><!--[--><!--]--> DolphinDB 稳定版集群配置 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>DolphinDB Beta版</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/200/index.html#" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB Beta版手册"><!--[--><!--]--> DolphinDB Beta版手册 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/200/DatabaseandDistributedComputing/Configuration/StandaloneMode.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB Beta版配置"><!--[--><!--]--> DolphinDB Beta版配置 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.dolphindb.cn/cn/help/200/DatabaseandDistributedComputing/Configuration/ClusterMode.html" rel="noopener noreferrer" target="_blank" aria-label="DolphinDB Beta版集群配置"><!--[--><!--]--> DolphinDB Beta版集群配置 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="选择语言"><span class="title">选择语言</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html" class="router-link-active router-link-exact-active router-link-active" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/en/" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/dolphindb/dolphindb-k8s/blob/master/README_CN.md" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">在新窗口打开</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">Kubernetes安装 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/zh/reference/kubernetes/installer/minikube.html" class="sidebar-item" aria-label="Minikube集群"><!--[--><!--]--> Minikube集群 <!--[--><!--]--></a><!----></li><li><a href="/zh/reference/kubernetes/installer/kubernetes-cluster.html" class="sidebar-item" aria-label="Kubernetes集群"><!--[--><!--]--> Kubernetes集群 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Kubernetes高可用集群"><!--[--><!--]--> Kubernetes高可用集群 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#整体架构" class="router-link-active router-link-exact-active sidebar-item" aria-label="整体架构"><!--[--><!--]--> 整体架构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#环境信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="环境信息"><!--[--><!--]--> 环境信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#配置服务器" class="router-link-active router-link-exact-active sidebar-item" aria-label="配置服务器"><!--[--><!--]--> 配置服务器 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#基础环境配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="基础环境配置"><!--[--><!--]--> 基础环境配置 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#配置-etc-hosts" class="router-link-active router-link-exact-active sidebar-item" aria-label="配置/etc/hosts"><!--[--><!--]--> 配置/etc/hosts <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#安装keepalived" class="router-link-active router-link-exact-active sidebar-item" aria-label="安装Keepalived"><!--[--><!--]--> 安装Keepalived <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#环境信息-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="环境信息"><!--[--><!--]--> 环境信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#keepalived配置文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="Keepalived配置文件"><!--[--><!--]--> Keepalived配置文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#容器启动keepalived" class="router-link-active router-link-exact-active sidebar-item" aria-label="容器启动Keepalived"><!--[--><!--]--> 容器启动Keepalived <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#安装haproxy" class="router-link-active router-link-exact-active sidebar-item" aria-label="安装HAProxy"><!--[--><!--]--> 安装HAProxy <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#环境信息-2" class="router-link-active router-link-exact-active sidebar-item" aria-label="环境信息"><!--[--><!--]--> 环境信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#haproxy配置文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="HAProxy配置文件"><!--[--><!--]--> HAProxy配置文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#准备socket文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="准备socket文件"><!--[--><!--]--> 准备socket文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#容器启动haproxy" class="router-link-active router-link-exact-active sidebar-item" aria-label="容器启动HAProxy"><!--[--><!--]--> 容器启动HAProxy <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#查看haproxy监控" class="router-link-active router-link-exact-active sidebar-item" aria-label="查看HAProxy监控"><!--[--><!--]--> 查看HAProxy监控 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#安装master节点" class="router-link-active router-link-exact-active sidebar-item" aria-label="安装Master节点"><!--[--><!--]--> 安装Master节点 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#准备kubeadm配置文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="准备Kubeadm配置文件"><!--[--><!--]--> 准备Kubeadm配置文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#执行初始化指令" class="router-link-active router-link-exact-active sidebar-item" aria-label="执行初始化指令"><!--[--><!--]--> 执行初始化指令 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#配置kubeconfig" class="router-link-active router-link-exact-active sidebar-item" aria-label="配置Kubeconfig"><!--[--><!--]--> 配置Kubeconfig <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#安装kubernetes网络组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="安装Kubernetes网络组件"><!--[--><!--]--> 安装Kubernetes网络组件 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#查看集群信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="查看集群信息"><!--[--><!--]--> 查看集群信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#添加master节点" class="router-link-active router-link-exact-active sidebar-item" aria-label="添加Master节点"><!--[--><!--]--> 添加Master节点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#添加worker节点" class="router-link-active router-link-exact-active sidebar-item" aria-label="添加Worker节点"><!--[--><!--]--> 添加Worker节点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/zh/reference/kubernetes/installer/kubernetes-cluster-ha.html#卸载kubernetes集群" class="router-link-active router-link-exact-active sidebar-item" aria-label="卸载Kubernetes集群"><!--[--><!--]--> 卸载Kubernetes集群 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">CSI安装 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/zh/reference/kubernetes/installer/csi-localpath.html" class="sidebar-item" aria-label="LocalPath CSI安装"><!--[--><!--]--> LocalPath CSI安装 <!--[--><!--]--></a><!----></li><li><a href="/zh/reference/kubernetes/installer/csi-ceph.html" class="sidebar-item" aria-label="Ceph CSI安装"><!--[--><!--]--> Ceph CSI安装 <!--[--><!--]--></a><!----></li><li><a href="/zh/reference/kubernetes/installer/csi-nfs.html" class="sidebar-item" aria-label="NFS CSI安装"><!--[--><!--]--> NFS CSI安装 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">CNI安装 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/zh/reference/kubernetes/installer/cni-calico.html" class="sidebar-item" aria-label="Calico CNI安装"><!--[--><!--]--> Calico CNI安装 <!--[--><!--]--></a><!----></li><li><a href="/zh/reference/kubernetes/installer/cni-cilium-ebpf.html" class="sidebar-item" aria-label="Cilium/EBPF CNI安装"><!--[--><!--]--> Cilium/EBPF CNI安装 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="kubernetes高可用集群" tabindex="-1"><a class="header-anchor" href="#kubernetes高可用集群" aria-hidden="true">#</a> Kubernetes高可用集群</h1><p>高可用K8S集群是指K8S的Master节点个数不少于3个，K8S管理面每个组件副本数不少于3个的Kubernetes集群。</p><h2 id="整体架构" tabindex="-1"><a class="header-anchor" href="#整体架构" aria-hidden="true">#</a> 整体架构</h2><p><img src="/images/reference/kubernetes/architecture-ha-k8s-cluster.png" alt="Kubernetes高可用集群整体架构"></p><h2 id="环境信息" tabindex="-1"><a class="header-anchor" href="#环境信息" aria-hidden="true">#</a> 环境信息</h2><ul><li><p>Master节点：</p><ul><li>192.168.100.13 cnserver20</li><li>192.168.100.14 cnserver21</li><li>192.168.100.15 cnserver22</li></ul></li><li><p>Worker节点：</p><ul><li>192.168.100.10 cnserver17</li><li>192.168.100.11 cnserver18</li><li>192.168.100.12 cnserver19</li></ul></li><li><p>虚拟ip:</p><ul><li>kubernetes-vip：192.168.100.99</li></ul></li></ul><div class="custom-container tip"><p class="custom-container-title">提示</p><p><code>kubernetes-vip</code>用于Keepalived的虚拟vip配置，与机器在同一网段，使用同一网卡</p></div><h2 id="配置服务器" tabindex="-1"><a class="header-anchor" href="#配置服务器" aria-hidden="true">#</a> 配置服务器</h2><h3 id="基础环境配置" tabindex="-1"><a class="header-anchor" href="#基础环境配置" aria-hidden="true">#</a> 基础环境配置</h3><p>参考<a href="/zh/reference/kubernetes/installer/kubernetes-cluster.html#%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8" class="">Kubernetes集群-配置服务器</a>。</p><h3 id="配置-etc-hosts" tabindex="-1"><a class="header-anchor" href="#配置-etc-hosts" aria-hidden="true">#</a> 配置/etc/hosts</h3><p>配置/etc/hosts非必要操作，该配置是为了便于后续直接通过主机名称/vip名称进行操作，如不配置，后续操作中的域主机名称/vip名称需要替换成相应ip.</p><p>配置方式为在所有节点的<code>/etc/hosts</code>文件中添加节点信息和vip信息：</p><div class="language-text ext-text line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">192.168.100.10 cnserver17</span></span>
<span class="line"><span style="color:#D4D4D4;">192.168.100.11 cnserver18</span></span>
<span class="line"><span style="color:#D4D4D4;">192.168.100.12 cnserver19</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span>
<span class="line"><span style="color:#D4D4D4;">192.168.100.13 cnserver20</span></span>
<span class="line"><span style="color:#D4D4D4;">192.168.100.14 cnserver21</span></span>
<span class="line"><span style="color:#D4D4D4;">192.168.100.15 cnserver22</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span>
<span class="line"><span style="color:#D4D4D4;">192.168.100.99 kubernetes-vip</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装keepalived" tabindex="-1"><a class="header-anchor" href="#安装keepalived" aria-hidden="true">#</a> 安装Keepalived</h2><p>Keepalived是一种高可用方案，通过VIP(虚拟IP)和心跳检测来实现高可用。</p><p>Keepalived通常有Master和Backup两个角色，一般情况下有1个master和多个backup.</p><p>Master会绑定VIP到自己网卡上，对外提供服务。</p><p>Master和Backup会定时确定对方状态，当Master不可用的时候，Backup会通知网关，并把VIP绑定到自己的网卡上，实现服务不中断，即为高可用。</p><h3 id="环境信息-1" tabindex="-1"><a class="header-anchor" href="#环境信息-1" aria-hidden="true">#</a> 环境信息</h3><p>搭建Keepalied的机器(Kubernetes高可用集群的Master节点)：</p><ul><li>192.168.100.13 cnserver20</li><li>192.168.100.14 cnserver21</li><li>192.168.100.15 cnserver22</li></ul><h3 id="keepalived配置文件" tabindex="-1"><a class="header-anchor" href="#keepalived配置文件" aria-hidden="true">#</a> Keepalived配置文件</h3><p>在每个节点上配置相应的keepalived.conf，见附件<a href="/downloads/Keepalived%E9%85%8D%E7%BD%AE.zip">Keepalived配置</a>。</p><p>配置文件中需要修改的有如下部分：</p><div class="language-text ext-text line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">vrrp_instance VI_1 {</span></span>
<span class="line"><span style="color:#D4D4D4;">  interface em3 # 此处通过ip addr命令根据实际填写，本机ip所在网卡</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span>
<span class="line"><span style="color:#D4D4D4;">  state BACKUP# 一台节点配置为MASTER，其他节点配置为BACKUP</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span>
<span class="line"><span style="color:#D4D4D4;">  unicast_src_ip 192.168.100.15  #设置本机内网ip</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span></span>
<span class="line"><span style="color:#D4D4D4;">  #其他两台master ip</span></span>
<span class="line"><span style="color:#D4D4D4;">  unicast_peer {</span></span>
<span class="line"><span style="color:#D4D4D4;">        192.168.100.13</span></span>
<span class="line"><span style="color:#D4D4D4;">        192.168.100.14</span></span>
<span class="line"><span style="color:#D4D4D4;">  }</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span>
<span class="line"><span style="color:#D4D4D4;">  virtual_ipaddress {</span></span>
<span class="line"><span style="color:#D4D4D4;">    192.168.100.99  # vip 虚拟ip</span></span>
<span class="line"><span style="color:#D4D4D4;">  }</span></span>
<span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="容器启动keepalived" tabindex="-1"><a class="header-anchor" href="#容器启动keepalived" aria-hidden="true">#</a> 容器启动Keepalived</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;"># $keepalivedConfPath: keepalived.conf文件路径</span></span>
<span class="line"><span style="color:#D4D4D4;">docker run \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --name=keepalived \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --cap-add=NET_ADMIN \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --cap-add=NET_BROADCAST \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --cap-add=NET_RAW \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --net=host \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --restart=always \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --volume </span><span style="color:#9CDCFE;">$keepalivedConfPath</span><span style="color:#D4D4D4;">:/container/service/keepalived/assets/keepalived.conf \</span></span>
<span class="line"><span style="color:#D4D4D4;">    -d osixia/keepalived:2.0.20 \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --copy-service</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装haproxy" tabindex="-1"><a class="header-anchor" href="#安装haproxy" aria-hidden="true">#</a> 安装HAProxy</h2><p>HAProxy 是一款提供高可用性、负载均衡以及基于TCP（第四层）和HTTP（第七层）应用的代理软件。</p><p>HAProxy作为负载均衡时，可以按照指定策略（比如轮询）将流量转发到相应服务中。</p><p>例如当前Server有三个副本由HAProxy进行负载均衡，HAProxy可将客户端对Server的访问请求路由到这三个副本中的一个。这样做有以下好处：</p><ul><li>避免所有请求集中转发到某个server，有效降低单个服务组件的压力;</li><li>当某个server副本宕机，HAProxy可将流量转发到健康的server端，从而保证服务的高可用。</li></ul><h3 id="环境信息-2" tabindex="-1"><a class="header-anchor" href="#环境信息-2" aria-hidden="true">#</a> 环境信息</h3><p>搭建HAProxy的机器(Kubernetes高可用集群的Master节点)：</p><ul><li>192.168.100.13 cnserver20</li><li>192.168.100.14 cnserver21</li><li>192.168.100.15 cnserver22</li></ul><h3 id="haproxy配置文件" tabindex="-1"><a class="header-anchor" href="#haproxy配置文件" aria-hidden="true">#</a> HAProxy配置文件</h3><p>在每个节点上配置<code>haproxy.cfg</code>，见附件<a href="/downloads/haproxy.cfg">HAProxy配置</a>。</p><p>其中，主要的负载相关配置如下：</p><div class="language-text ext-text line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">#---------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#D4D4D4;"># main frontend which proxys to the backends</span></span>
<span class="line"><span style="color:#D4D4D4;">#---------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#D4D4D4;">frontend  kubernetes-apiserver</span></span>
<span class="line"><span style="color:#D4D4D4;">    mode tcp</span></span>
<span class="line"><span style="color:#D4D4D4;">    bind *:9443  ## 监听9443端口</span></span>
<span class="line"><span style="color:#D4D4D4;">    # bind *:443 ssl # To be completed ....</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span>
<span class="line"><span style="color:#D4D4D4;">    acl url_static       path_beg       -i /static /images /javascript /stylesheets</span></span>
<span class="line"><span style="color:#D4D4D4;">    acl url_static       path_end       -i .jpg .gif .png .css .js</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span>
<span class="line"><span style="color:#D4D4D4;">    default_backend             kubernetes-apiserver</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span>
<span class="line"><span style="color:#D4D4D4;">#---------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#D4D4D4;"># round robin balancing between the various backends</span></span>
<span class="line"><span style="color:#D4D4D4;">#---------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#D4D4D4;">backend kubernetes-apiserver</span></span>
<span class="line"><span style="color:#D4D4D4;">    mode        tcp  # 模式tcp</span></span>
<span class="line"><span style="color:#D4D4D4;">    balance     roundrobin  # 采用轮询的负载算法</span></span>
<span class="line"><span style="color:#D4D4D4;"># k8s-apiservers backend  # 配置apiserver，端口6443</span></span>
<span class="line"><span style="color:#D4D4D4;"> server cnserver20 192.168.100.13:6443 check</span></span>
<span class="line"><span style="color:#D4D4D4;"> server cnserver21 192.168.100.14:6443 check</span></span>
<span class="line"><span style="color:#D4D4D4;"> server cnserver22 192.168.100.15:6443 check</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="准备socket文件" tabindex="-1"><a class="header-anchor" href="#准备socket文件" aria-hidden="true">#</a> 准备socket文件</h3><p>准备一个空的文件夹路径<code>$statsDirPath</code>用于haproxy持久化stats文件。</p><h3 id="容器启动haproxy" tabindex="-1"><a class="header-anchor" href="#容器启动haproxy" aria-hidden="true">#</a> 容器启动HAProxy</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;"># $haproxyConfDirPath: haproxy.conf文件所在文件夹路径</span></span>
<span class="line"><span style="color:#6A9955;"># $statsDirPath: 用于haproxy持久化stats文件的文件夹路径</span></span>
<span class="line"><span style="color:#D4D4D4;">docker run \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --name=haproxy \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --net=host \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --restart=always \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --volume </span><span style="color:#9CDCFE;">$haproxyConfDirPath</span><span style="color:#D4D4D4;">:/usr/local/etc/haproxy:ro \</span></span>
<span class="line"><span style="color:#D4D4D4;">    --volume </span><span style="color:#9CDCFE;">$statsDirPath</span><span style="color:#D4D4D4;">:/var/lib/haproxy \</span></span>
<span class="line"><span style="color:#D4D4D4;">    -d haproxy:2.3.6</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查看haproxy监控" tabindex="-1"><a class="header-anchor" href="#查看haproxy监控" aria-hidden="true">#</a> 查看HAProxy监控</h3><p>在配置文件<code>haproxy.cfg</code>中定义了HAProxy的监控配置如下：</p><div class="language-text ext-text line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">#---------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#D4D4D4;"># haproxy monitor</span></span>
<span class="line"><span style="color:#D4D4D4;">#---------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#D4D4D4;">listen admin_stats</span></span>
<span class="line"><span style="color:#D4D4D4;">        stats   enable</span></span>
<span class="line"><span style="color:#D4D4D4;">        bind    *:9445    #监听的ip端口号</span></span>
<span class="line"><span style="color:#D4D4D4;">        mode    http    #开关</span></span>
<span class="line"><span style="color:#D4D4D4;">        option  httplog</span></span>
<span class="line"><span style="color:#D4D4D4;">        log     global</span></span>
<span class="line"><span style="color:#D4D4D4;">        maxconn 10</span></span>
<span class="line"><span style="color:#D4D4D4;">        stats   refresh 30s   #统计页面自动刷新时间</span></span>
<span class="line"><span style="color:#D4D4D4;">        stats   uri /haproxy#访问的uri   ip:9445/haproxy</span></span>
<span class="line"><span style="color:#D4D4D4;">        stats   realm haproxy</span></span>
<span class="line"><span style="color:#D4D4D4;">        stats   auth admin:admin  #认证用户名和密码</span></span>
<span class="line"><span style="color:#D4D4D4;">        stats   hide-version   #隐藏HAProxy的版本号</span></span>
<span class="line"><span style="color:#D4D4D4;">        stats   admin if TRUE   #管理界面，如果认证成功了，可通过webui管理节点</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>容器启动之后可以在web上访问来查看haproxy的监控信息，访问地址如下：</p><div class="language-text ext-text line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;"># $ip: 由于容器启动命令中制定了--net=host，因此此处的$ip指HAProxy运行的主机的ip</span></span>
<span class="line"><span style="color:#D4D4D4;"># 登录用户名密码为配置中的`stats auth`指定，均为admin</span></span>
<span class="line"><span style="color:#D4D4D4;">http://$ip:9445/haproxy</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装master节点" tabindex="-1"><a class="header-anchor" href="#安装master节点" aria-hidden="true">#</a> 安装Master节点</h2><p>此处选择先安装Master节点<code>192.168.100.13 cnserver20</code>，从而完成高可用Kubernetes集群的初始化。</p><h3 id="准备kubeadm配置文件" tabindex="-1"><a class="header-anchor" href="#准备kubeadm配置文件" aria-hidden="true">#</a> 准备Kubeadm配置文件</h3><p>Kubeadm的配置文件<code>kubeadm.yaml</code>内容如下：</p><div class="language-text ext-text line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">apiVersion: kubeadm.k8s.io/v1beta2</span></span>
<span class="line"><span style="color:#D4D4D4;">kind: ClusterConfiguration</span></span>
<span class="line"><span style="color:#D4D4D4;">kubernetesVersion: v1.23.1</span></span>
<span class="line"><span style="color:#D4D4D4;">imageRepository: registry.cn-hangzhou.aliyuncs.com/google_containers</span></span>
<span class="line"><span style="color:#D4D4D4;">controlPlaneEndpoint: &quot;kubernetes-vip:9443&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">networking:</span></span>
<span class="line"><span style="color:#D4D4D4;">  dnsDomain: cluster.local</span></span>
<span class="line"><span style="color:#D4D4D4;">  podSubnet: 10.244.0.0/16</span></span>
<span class="line"><span style="color:#D4D4D4;">  serviceSubnet: 10.211.0.0/12</span></span>
<span class="line"><span style="color:#D4D4D4;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><ul><li><code>kubernetes-vip</code>为<code>/etc/hosts</code>文件中配置Keepalived虚拟IP域名，详见<a href="#%E9%85%8D%E7%BD%AEetchosts">配置/etc/hosts</a>.</li><li>此处使用<code>Flannel</code>作为网络组件,对应的&quot;podSubnet&quot;为<code>10.244.0.0/16</code>；</li><li>若使用<code>Calico</code>作为网络组件,对应的&quot;podSubnet&quot;为<code>192.168.0.0/16</code>.</li></ul></div><h3 id="执行初始化指令" tabindex="-1"><a class="header-anchor" href="#执行初始化指令" aria-hidden="true">#</a> 执行初始化指令</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">kubeadm init --config kubeadm.yaml --upload-certs</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">注意</p><p>如果此前执行过以上脚本或者<code>Kubeadm</code>安装指令，则应在执行以上脚本之前执行以下命令：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">kubeadm reset</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><p>初始化完成后，将打印如下消息：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">Your Kubernetes control-plane has initialized successfully!</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">To start using your cluster, you need to run the following as a regular user:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">  mkdir -p </span><span style="color:#9CDCFE;">$HOME</span><span style="color:#D4D4D4;">/.kube</span></span>
<span class="line"><span style="color:#D4D4D4;">  sudo cp -i /etc/kubernetes/admin.conf </span><span style="color:#9CDCFE;">$HOME</span><span style="color:#D4D4D4;">/.kube/config</span></span>
<span class="line"><span style="color:#D4D4D4;">  sudo chown </span><span style="color:#CE9178;">$(id -u)</span><span style="color:#D4D4D4;">:</span><span style="color:#CE9178;">$(id -g)</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">$HOME</span><span style="color:#D4D4D4;">/.kube/config</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">Alternatively, </span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> you are the root user, you can run:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">export</span><span style="color:#D4D4D4;"> KUBECONFIG=/etc/kubernetes/admin.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">You should now deploy a pod network to the cluster.</span></span>
<span class="line"><span style="color:#D4D4D4;">Run </span><span style="color:#CE9178;">&quot;kubectl apply -f [podnetwork].yaml&quot;</span><span style="color:#D4D4D4;"> with one of the options listed at:</span></span>
<span class="line"><span style="color:#D4D4D4;">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">You can now join any number of the control-plane node running the following </span><span style="color:#DCDCAA;">command</span><span style="color:#D4D4D4;"> on each as root:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">  kubeadm join kubernetes-vip:9443 --token grv9o6.75venx9x7sajjowp \</span></span>
<span class="line"><span style="color:#D4D4D4;">        --discovery-token-ca-cert-hash sha256:ea92e650eed7e5df76ab99ac545f61713d3f1ff9001a3281a1f5c71ece7309a5 \</span></span>
<span class="line"><span style="color:#D4D4D4;">        --control-plane --certificate-key 1e610197e25fbb02e695db6124f21874ff865044cd17b2a3fe5ca73b0d8a791c</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">Please note that the certificate-key gives access to cluster sensitive data, keep it secret!</span></span>
<span class="line"><span style="color:#D4D4D4;">As a safeguard, uploaded-certs will be deleted </span><span style="color:#C586C0;">in</span><span style="color:#D4D4D4;"> two hours; If necessary, you can use</span></span>
<span class="line"><span style="color:#CE9178;">&quot;kubeadm init phase upload-certs --upload-certs&quot;</span><span style="color:#D4D4D4;"> to reload certs afterward.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">Then you can join any number of worker nodes by running the following on each as root:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">kubeadm join kubernetes-vip:9443 --token grv9o6.75venx9x7sajjowp \</span></span>
<span class="line"><span style="color:#D4D4D4;">        --discovery-token-ca-cert-hash sha256:ea92e650eed7e5df76ab99ac545f61713d3f1ff9001a3281a1f5c71ece7309a5</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置kubeconfig" tabindex="-1"><a class="header-anchor" href="#配置kubeconfig" aria-hidden="true">#</a> 配置Kubeconfig</h3><p>参考<a href="/zh/reference/kubernetes/installer/kubernetes-cluster.html#%E9%85%8D%E7%BD%AEkubeconfig" class="">Kubernetes集群-配置Kubeconfig</a>.</p><h3 id="安装kubernetes网络组件" tabindex="-1"><a class="header-anchor" href="#安装kubernetes网络组件" aria-hidden="true">#</a> 安装Kubernetes网络组件</h3><p>参考<a href="/zh/reference/kubernetes/installer/kubernetes-cluster.html#%E5%AE%89%E8%A3%85kubernetes%E7%BD%91%E7%BB%9C%E7%BB%84%E4%BB%B6" class="">Kubernetes集群-安装Kubernetes网络组件</a>。</p><h2 id="查看集群信息" tabindex="-1"><a class="header-anchor" href="#查看集群信息" aria-hidden="true">#</a> 查看集群信息</h2><p>参考<a href="/zh/reference/kubernetes/installer/kubernetes-cluster.html#%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E4%BF%A1%E6%81%AF" class="">Kubernetes集群-查看集群信息</a>。</p><h2 id="添加master节点" tabindex="-1"><a class="header-anchor" href="#添加master节点" aria-hidden="true">#</a> 添加Master节点</h2><p>集群初始化完成后打印出的信息中含有<code>--control-plane</code>参数的指令可用于添加<code>Master</code>节点。</p><p>在需要作为Master节点添加到集群中的节点上执行:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">kubeadm join kubernetes-vip:9443 --token grv9o6.75venx9x7sajjowp \</span></span>
<span class="line"><span style="color:#D4D4D4;">      --discovery-token-ca-cert-hash sha256:ea92e650eed7e5df76ab99ac545f61713d3f1ff9001a3281a1f5c71ece7309a5 \</span></span>
<span class="line"><span style="color:#D4D4D4;">      --control-plane --certificate-key 1e610197e25fbb02e695db6124f21874ff865044cd17b2a3fe5ca73b0d8a791c</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><ul><li>Kubeadm更多参数参考<a href="/zh/reference/tools/kubeadm.html#%E5%8F%82%E6%95%B0" class="">Kubeadm参数</a>;</li><li>若Token已过期，参考<a href="/zh/reference/kubernetes/installer-config.html#%E9%87%8D%E6%96%B0%E7%94%9F%E6%88%90%E5%A2%9E%E5%8A%A0%E8%8A%82%E7%82%B9%E7%9A%84token" class="">重新生成增加节点的Token</a>;</li><li>若Certificate已过期，参考<a href="/zh/reference/kubernetes/installer-config.html#%E9%87%8D%E6%96%B0%E7%94%9F%E6%88%90%E5%A2%9E%E5%8A%A0%E8%8A%82%E7%82%B9%E7%9A%84certificate" class="">重新生成增加节点的Certificate</a>;</li><li>添加Master节点之后，亦需要配置<code>Kubeconfig</code>，参考<a href="/zh/reference/kubernetes/installer-config.html#%E9%85%8D%E7%BD%AEkubeconfig" class="">配置Kubeconfig</a>.</li></ul></div><h2 id="添加worker节点" tabindex="-1"><a class="header-anchor" href="#添加worker节点" aria-hidden="true">#</a> 添加Worker节点</h2><p>集群初始化完成后打印出的信息中不含有<code>--control-plane</code>参数的指令可用于添加<code>Worker</code>节点。</p><p>参考<a href="/zh/reference/kubernetes/installer/kubernetes-cluster.html#%E6%B7%BB%E5%8A%A0worker%E8%8A%82%E7%82%B9" class="">Kubernetes集群-添加Worker节点</a>。</p><h2 id="卸载kubernetes集群" tabindex="-1"><a class="header-anchor" href="#卸载kubernetes集群" aria-hidden="true">#</a> 卸载Kubernetes集群</h2><p>参考<a href="/zh/reference/kubernetes/installer/kubernetes-cluster.html#%E5%8D%B8%E8%BD%BDkubernetes%E9%9B%86%E7%BE%A4" class="">Kubernetes集群-卸载Kubernetes集群</a>。</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: zhiqiang.xu@dolphindb.com">徐志强</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/zh/reference/kubernetes/installer/kubernetes-cluster.html" class="" aria-label="Kubernetes集群"><!--[--><!--]--> Kubernetes集群 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.0ebc3338.js" defer></script>
  </body>
</html>
