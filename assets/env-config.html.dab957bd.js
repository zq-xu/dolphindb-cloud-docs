import{_ as s,o as n,c as l,e as a}from"./app.70434bce.js";const p={},o=a(`<h1 id="环境配置" tabindex="-1"><a class="header-anchor" href="#环境配置" aria-hidden="true">#</a> 环境配置</h1><p><code>DolphinDB MGR</code>的环境配置集中在<code>Env Config</code>中，其表现形式是<code>Configmap</code>资源，对应<code>DolphinDB MGR</code>的Chart包中的 <code>dolphindb-mgr/templates/envconfig.yaml</code>文件中。</p><h2 id="配置详情" tabindex="-1"><a class="header-anchor" href="#配置详情" aria-hidden="true">#</a> 配置详情</h2><p><code>Env Config</code>的详细内容如下所示：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#CE9178;">kubectl -ndolphindb get cm dolphindb-env-config -oyaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">#控制台输出如下:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">apiVersion</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1</span></span>
<span class="line"><span style="color:#569CD6;">kind</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">ConfigMap</span></span>
<span class="line"><span style="color:#569CD6;">metadata</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">namespace</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">dolphindb</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">name</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">dolphindb-env-config</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">labels</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">dolphindb.io/component.config</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">config</span></span>
<span class="line"><span style="color:#569CD6;">data</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">env-config</span><span style="color:#D4D4D4;">: </span><span style="color:#C586C0;">|</span><span style="color:#569CD6;">-</span></span>
<span class="line"><span style="color:#6A9955;">##-----------------------------全局属性-----------------------------##</span></span>
<span class="line"><span style="color:#6A9955;">## 全局属性作用于所有DolphinDB MGR管理面组件资源和DolphinDB运行时资源</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">global</span><span style="color:#D4D4D4;">:                                             </span><span style="color:#6A9955;"># 全局属性</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">storageClass</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                                      </span><span style="color:#6A9955;"># 存储类名称，使用该存储类根据PVC来自动分配PV.</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">imageRepository</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">192.168.1.240/dolphindb</span><span style="color:#D4D4D4;">              </span><span style="color:#6A9955;"># 容器镜像仓库地址</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">localTimeFileHostPath</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">/etc/localtime</span><span style="color:#D4D4D4;">                 </span><span style="color:#6A9955;"># Kubernetes环境节点上时区文件所在路径，默认值/etc/localtime</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">customDomainSuffix</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                                </span><span style="color:#6A9955;"># 自定义域名后缀，用于替换Kubernetes集群默认内部域名后缀为svc.cluster.local</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">minPersistentVolumeSize</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                           </span><span style="color:#6A9955;"># PV最小空间大小，主要适用于有限制持久卷最小空间的公有云环境</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">nodeAffinity</span><span style="color:#D4D4D4;">:                                         </span><span style="color:#6A9955;"># 节点亲和性，影响DolphinDB相关Pod资源调度到哪些节点上，详情可参考Kubernetes节点亲和性的相关定义。此处表示DolphinDB相关Pod优先调度到具有&quot;dolphindb.io/pod: dolphindb&quot;标签的节点上。</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">preferredDuringSchedulingIgnoredDuringExecution</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">        - </span><span style="color:#569CD6;">preference</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#569CD6;">matchExpressions</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">            - </span><span style="color:#569CD6;">key</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">dolphindb.io/pod</span></span>
<span class="line"><span style="color:#D4D4D4;">              </span><span style="color:#569CD6;">operator</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">In</span></span>
<span class="line"><span style="color:#D4D4D4;">              </span><span style="color:#569CD6;">values</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">              - </span><span style="color:#CE9178;">dolphindb</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">weight</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">##-----------------------------DolphinDB属性-----------------------------##</span></span>
<span class="line"><span style="color:#6A9955;">## DolphinDB属性仅作用于DolphinDB运行时资源，在全局属性的基础上进行叠加。如有相同字段，则在全局属性的基础上进行覆盖。</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">dolphindb</span><span style="color:#D4D4D4;">:                                          </span><span style="color:#6A9955;"># DolphinDB属性</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">serviceType</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">NodePort</span><span style="color:#D4D4D4;">                             </span><span style="color:#6A9955;"># DolphinDB对外提供服务的服务类型，</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">coreDumpDir</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">/data/ddb/core</span><span style="color:#D4D4D4;">                       </span><span style="color:#6A9955;"># core dump文件路径，在DolphinDB进程触发core dump时，相应的core dump文件生成路径</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">controllerDataSize</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">200Mi</span><span style="color:#D4D4D4;">                         </span><span style="color:#6A9955;"># DolphinDB的controller实例的数据需要持久卷的空间</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">datanodeDataSize</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">200Mi</span><span style="color:#D4D4D4;">                           </span><span style="color:#6A9955;"># DolphinDB的datanode实例的数据需要持久卷的空间</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">localTimeFileMountPath</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">/etc/localtime</span><span style="color:#D4D4D4;">            </span><span style="color:#6A9955;"># Kubernetes环境节点上时区文件所在路径，默认值/etc/localtime</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">disableExporter</span><span style="color:#D4D4D4;">:  </span><span style="color:#569CD6;">false</span><span style="color:#D4D4D4;">                           </span><span style="color:#6A9955;"># 是否禁用dolphindb-exporter组件，默认false,表示使用dolphindb-exporter来采集DolphinDB指标信息，以便于汇总到Prometheus服务</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">logCleanLimit</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">0.9</span><span style="color:#D4D4D4;">                                </span><span style="color:#6A9955;"># 日志清理阈值，默认为0.9,表示当DolphinDB所在容器的日志文件大小达到日志的PVC定义的存储空间的90%时，开始清理该容器中的历史日志文件</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">resources</span><span style="color:#D4D4D4;">:                                        </span><span style="color:#6A9955;"># DolphinDB License指定的资源配置，主要用于可视化界面上DolphinDB的默认资源配置</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">limits</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">cpu</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">1</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">memory</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">1Gi</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">requests</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">cpu</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">1</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">memory</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">1Gi</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">images</span><span style="color:#D4D4D4;">:                                           </span><span style="color:#6A9955;"># DolphinDB MGR可视化界面上展示的DolphinDB版本号及相关镜像，默认情况下DolphinDB的镜像tag和版本号保持一致。若需要自定义镜像名称或tag，则需要在每个版本的images字段下指定，可参考v2.00.4版本。</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">versions</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.30.14</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.30.15</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.30.16</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.30.17</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.30.18</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.30.19</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.30.20</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v2.00.3</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v2.00.4</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#569CD6;">images</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">               </span><span style="color:#569CD6;">dolphindb</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v2.00.4-patch3</span><span style="color:#D4D4D4;">                </span><span style="color:#6A9955;"># 此处表示v2.00.4版本的DolphinDB使用的DolphinDB镜像的tag为&quot;v2.00.4-patch3&quot;，若需要设置镜像名称，则以&quot;$name:$tag&quot;的格式提供即可。</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v2.00.5</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v2.00.6</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v2.00.7</span></span>
<span class="line"><span style="color:#D4D4D4;">          - </span><span style="color:#569CD6;">version</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v2.00.8</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">default</span><span style="color:#D4D4D4;">:                                        </span><span style="color:#6A9955;"># 此处指定为DolphinDB稳定运行提供辅助功能的镜像，默认情况下，只需要提供版本号。若需要设置镜像名称，则以&quot;$name:$tag&quot;的格式提供即可。</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">dolphindb-config-loader</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.1.0</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">dolphindb-service-manager</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.1.0</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">dolphindb-exporter</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.1.0</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">dolphindb-cleaner</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">v1.1.0</span></span>
<span class="line"><span style="color:#D4D4D4;">          </span><span style="color:#569CD6;">promtail</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">2.4.1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改配置" tabindex="-1"><a class="header-anchor" href="#修改配置" aria-hidden="true">#</a> 修改配置</h2><p>可通过以下方式修改环境配置：</p><ul><li>直接修改环境中<code>Env Config</code>对应的<code>Configmap</code>资源；</li><li>通过指定<code>DolphinDB MGR</code>部署参数升级<code>DolphinDB MGR</code>(影响较大，不建议)；</li><li>通过可视化界面修改(TODO,该功能尚未上线)；</li></ul><div class="custom-container tip"><p class="custom-container-title">提示</p><p>多数组件实现了配置热加载，但某些配置项可能需要事件触发才会作用到环境中。 因此，修改<code>Env Config</code>后，可通过重启相应组件使得配置强制刷新，从而快速生效。</p></div>`,9),e=[o];function D(c,i){return n(),l("div",null,e)}const t=s(p,[["render",D],["__file","env-config.html.vue"]]);export{t as default};
