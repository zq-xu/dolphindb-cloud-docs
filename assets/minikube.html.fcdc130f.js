import{_ as a,r as l,o as i,c as o,a as s,b as e,d as r,w as c,e as d}from"./app.70434bce.js";const t={},p=s("h1",{id:"minikube集群",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#minikube集群","aria-hidden":"true"},"#"),e(" Minikube集群")],-1),u=s("p",null,"Minikube是单节点的Kubernetes环境，常用于学习使用或作为开发环境。",-1),b=s("h2",{id:"搭建环境",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#搭建环境","aria-hidden":"true"},"#"),e(" 搭建环境")],-1),h=s("p",null,"服务器信息和基础环境如下：",-1),v=s("li",null,"OS: Linux",-1),m=s("li",null,"Kubectl: v1.22.3",-1),D=s("li",null,"Minikube: v1.24.0",-1),g=s("li",null,"Golang: 1.15.15",-1),k=d(`<div class="custom-container tip"><p class="custom-container-title">提示</p><p>如果使用中国境内网络，为避免网络影响，可以设置GOPROXY为以下任意一个：</p><ul><li>export GOPROXY=&quot;https://proxy.golang.org,direct&quot;</li><li>export GOPROXY=&quot;https://goproxy.cn&quot;</li></ul></div><h2 id="安装kubectl" tabindex="-1"><a class="header-anchor" href="#安装kubectl" aria-hidden="true">#</a> 安装Kubectl</h2><ul><li><strong>步骤一</strong> 下载二进制文件</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">curl -LO https://storage.googleapis.com/kubernetes-release/release/</span><span style="color:#CE9178;">$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)</span><span style="color:#D4D4D4;">/bin/linux/amd64/kubectl</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>步骤二</strong> 修改二进制文件权限及路径</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">sudo chmod +x kubectl </span></span>
<span class="line"><span style="color:#D4D4D4;">sudo mv ./kubectl /usr/local/bin/kubectl</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装minikube" tabindex="-1"><a class="header-anchor" href="#安装minikube" aria-hidden="true">#</a> 安装Minikube</h2><ul><li><strong>步骤一</strong> 下载二进制文件</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>步骤二</strong> 修改二进制文件权限及路径</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">sudo chmod +x minikube</span></span>
<span class="line"><span style="color:#D4D4D4;">sudo install minikube /usr/local/bin/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>步骤二</strong> 安装依赖工具<code>conntrack</code></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">sudo yum install conntrack</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="使用minikube启动集群" tabindex="-1"><a class="header-anchor" href="#使用minikube启动集群" aria-hidden="true">#</a> 使用Minikube启动集群</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">minikube start --vm-driver=none --image-repository=registry.cn-hangzhou.aliyuncs.com/google_containers</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>启动参数说明：</p><ul><li>--vm-driver: 虚拟机驱动，如果使用本地服务器环境启动，设置为node即可；</li><li>--image-repository: 指定镜像仓库源，主要用于中国网络/私有网络无法访问google镜像的场景；</li><li>--kubernetes-version: 指定Kubernetes版本，如&quot;v1.18.20&quot;；</li></ul><h2 id="查看集群状态" tabindex="-1"><a class="header-anchor" href="#查看集群状态" aria-hidden="true">#</a> 查看集群状态</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">minikube status</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">## 健康的集群状态示例如下：</span></span>
<span class="line"><span style="color:#D4D4D4;">minikube</span></span>
<span class="line"><span style="color:#D4D4D4;">type: Control Plane</span></span>
<span class="line"><span style="color:#D4D4D4;">host: Running</span></span>
<span class="line"><span style="color:#D4D4D4;">kubelet: Running</span></span>
<span class="line"><span style="color:#D4D4D4;">apiserver: Running</span></span>
<span class="line"><span style="color:#D4D4D4;">kubeconfig: Configured</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="配置kubeconfig" tabindex="-1"><a class="header-anchor" href="#配置kubeconfig" aria-hidden="true">#</a> 配置Kubeconfig</h2><p>配置<code>Kubeconfig</code>,方可使用<code>Kubectl</code>指令直接操作Kubernetes集群：</p><ul><li><strong>步骤一</strong> 修改二进制文件权限及路径</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;"># USER: 操作用户的名称，取自环境变量$USER即可</span></span>
<span class="line"><span style="color:#6A9955;"># HOME: 操作用户的HOME路径，取自环境变量$HOME即可</span></span>
<span class="line"><span style="color:#D4D4D4;">sudo mv /root/.kube /root/.minikube </span><span style="color:#9CDCFE;">$HOME</span></span>
<span class="line"><span style="color:#D4D4D4;">sudo chown -R </span><span style="color:#9CDCFE;">$USER</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">$HOME</span><span style="color:#D4D4D4;">/.kube </span><span style="color:#9CDCFE;">$HOME</span><span style="color:#D4D4D4;">/.minikube</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>步骤二</strong> 修改文件<code>$HOME/.kube/config</code>,将其中的&quot;/root&quot;字段修改为<code>$HOME</code>对应路径。</li></ul><h2 id="可视化界面" tabindex="-1"><a class="header-anchor" href="#可视化界面" aria-hidden="true">#</a> 可视化界面</h2><p><code>Minikube Dashboard</code>是使用Minikube启动的Kubernetes自带的可视化界面，可使用以下指令启动：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">minikube dashboard --url</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;"># 启动成功示例如下：</span></span>
<span class="line"><span style="color:#D4D4D4;">* Verifying dashboard health ...</span></span>
<span class="line"><span style="color:#D4D4D4;">* Launching proxy ...</span></span>
<span class="line"><span style="color:#D4D4D4;">* Verifying proxy health ...</span></span>
<span class="line"><span style="color:#D4D4D4;">http://127.0.0.1:44509/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在安装Minikube的执行机上，使用本地浏览器中访问打印信息中的地址即可。</p><p>若需要在非安装机器上远程访问可视化界面，则可以使用<code>Kubectl</code>指令开启访问代理：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;"># 指定执行机的8001号端口作为代理</span></span>
<span class="line"><span style="color:#D4D4D4;"> nohup kubectl proxy --port=8001  --address=</span><span style="color:#CE9178;">&#39;0.0.0.0&#39;</span><span style="color:#D4D4D4;"> --accept-hosts=</span><span style="color:#CE9178;">&#39;^*$&#39;</span><span style="color:#D4D4D4;">  &gt;/dev/null 2&gt;&amp;1&amp;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>开启代理之后，即可使用以下地址远程访问可视化界面(ip为执行机ip)：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">http://</span><span style="color:#9CDCFE;">$ip</span><span style="color:#D4D4D4;">:8001/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,32);function y(E,x){const n=l("RouterLink");return i(),o("div",null,[p,u,b,h,s("ul",null,[v,m,D,g,s("li",null,[e("Docker: 1.41 ("),r(n,{to:"/zh/reference/docker/insatller.html"},{default:c(()=>[e("Docker安装")]),_:1}),e(")")])]),k])}const f=a(t,[["render",y],["__file","minikube.html.vue"]]);export{f as default};
