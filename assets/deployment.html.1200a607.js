import{_ as c,r,o as i,c as t,f as D,a as n,b as s,d as a,w as e,e as o}from"./app.70434bce.js";const d={},y=o('<h1 id="安装部署" tabindex="-1"><a class="header-anchor" href="#安装部署" aria-hidden="true">#</a> 安装部署</h1><p>DolphinDB MGR可以通过以下两种方式安装到Kubernetes环境中：</p><ul><li><a href="#%E5%8F%AF%E8%A7%86%E5%8C%96%E9%83%A8%E7%BD%B2">可视化部署</a>：快速安装DolphinDB MGR的可视化界面，更多功能可以在可视化界面中选择安装；</li><li><a href="#chart%E5%8C%85%E9%83%A8%E7%BD%B2">Chart包部署</a>：通过<code>Chart包</code>快速安装包含完整功能的DolphinDB MGR.</li></ul><h2 id="环境准备" tabindex="-1"><a class="header-anchor" href="#环境准备" aria-hidden="true">#</a> 环境准备</h2><h3 id="推荐环境" tabindex="-1"><a class="header-anchor" href="#推荐环境" aria-hidden="true">#</a> 推荐环境</h3><p>建议在如下基础环境上部署DolphinDB MGR：</p>',6),h={href:"https://kubernetes.io/zh-cn/docs/home/",target:"_blank",rel:"noopener noreferrer"},u={href:"https://docs.docker.com/",target:"_blank",rel:"noopener noreferrer"},v=n("h3",{id:"license准备",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#license准备","aria-hidden":"true"},"#"),s(" License准备")],-1),m=n("p",null,[s("在Kubernetes环境中，DolphinDB仍需要使用"),n("code",null,"DolphinDB License"),s("进行身份验证。")],-1),b={href:"https://www.dolphindb.cn/",target:"_blank",rel:"noopener noreferrer"},C=o(`<h3 id="coredump配置" tabindex="-1"><a class="header-anchor" href="#coredump配置" aria-hidden="true">#</a> CoreDump配置</h3><p>在Linux系统中，当进程发生core dump(比如程序崩溃)时，系统会终止当前进程并生成core dump文件。</p><p>如需配置DolphinDB的core dump文件路径，则需要在DolphinDB部署的宿主机上执行以下命令：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;"># \`/data/ddb/core\`为core dump文件在容器中的路径。</span></span>
<span class="line"><span style="color:#6A9955;"># 如果与当前宿主机的配置有冲突，则可使用宿主机路径或自定义路径，该路径记作$coreDumpDir</span></span>
<span class="line"><span style="color:#6A9955;"># 如果使用$coreDumpDir，则在部署DolphinDB-MGR时需指定参数dolphindb.coreDumpDir为$coreDumpDir.</span></span>
<span class="line"><span style="color:#DCDCAA;">echo</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&quot;/data/ddb/core/core.%p&quot;</span><span style="color:#D4D4D4;">  | sudo tee /proc/sys/kernel/core_pattern</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="可视化部署" tabindex="-1"><a class="header-anchor" href="#可视化部署" aria-hidden="true">#</a> 可视化部署</h2><p>部署环境可参考<a href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87">环境准备</a>。</p><p>可以使用如下指令快速安装<code>DolphinDB MGR</code>的可视化界面，然后在可视化界面中选择安装<code>DolphinDB MGR</code>的其他功能：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">TODO</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="chart包部署" tabindex="-1"><a class="header-anchor" href="#chart包部署" aria-hidden="true">#</a> Chart包部署</h2><p>部署环境可参考<a href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87">环境准备</a>。</p>`,10),A=n("a",{href:"#chart%E5%8C%85"},"Chart包",-1),E=o(`<ul><li><a href="#%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85">在线安装</a>：通过网络连接<code>Helm仓库</code>，直接安装<code>Helm仓库</code>中的<code>Chart包</code>；</li><li><a href="#%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85">离线安装</a>：将<code>Chart包</code>下载到本地，在本地安装（便于本地修改<code>Chart包</code>）。</li></ul><div class="custom-container warning"><p class="custom-container-title">注意</p><p>Helm工具在<code>v3.0.0</code>版本出现大规模变更，版本过低可能出现Chart包语法不兼容问题。</p></div><h3 id="chart包" tabindex="-1"><a class="header-anchor" href="#chart包" aria-hidden="true">#</a> Chart包</h3><p>DolphinDB MGR的Chart包结构及相关说明如下：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">$ dolphindb-mgr % tree</span></span>
<span class="line"><span style="color:#DCDCAA;">.</span></span>
<span class="line"><span style="color:#D4D4D4;">├── Chart.yaml                      </span><span style="color:#6A9955;"># Chart包的名称、版本等基本信息</span></span>
<span class="line"><span style="color:#D4D4D4;">├── charts                      </span><span style="color:#6A9955;"># DolphinDB MGR的子包，其中每个包是一个微服务组件</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── alertmanager                </span><span style="color:#6A9955;"># 告警组件，AlertManager微服务组件定义</span></span>
<span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── dolphindb-cloud-portal      </span><span style="color:#6A9955;"># 可视化界面组件，DolphinDB Cloud Portal微服务组件定义</span></span>
<span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── dolphindb-operator          </span><span style="color:#6A9955;"># DolphinDB CRD解析组件，DolphinDB Operator微服务组件定义</span></span>
<span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── dolphindb-webserver         </span><span style="color:#6A9955;"># REST API服务组件，DolphinDB Webserver微服务组件定义</span></span>
<span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── grafana                     </span><span style="color:#6A9955;"># 运维功能组件，Grafana微服务组件定义</span></span>
<span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── loki                        </span><span style="color:#6A9955;"># 日志存储组件，Loki微服务组件定义</span></span>
<span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── node-exporter               </span><span style="color:#6A9955;"># 节点指标采集组件，Node Exporter微服务组件定义</span></span>
<span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">│   └── prometheus                  </span><span style="color:#6A9955;"># 监控组件，Prometheus微服务组件定义</span></span>
<span class="line"><span style="color:#D4D4D4;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">├── crds                        </span><span style="color:#6A9955;"># crd资源定义所在路径</span></span>
<span class="line"><span style="color:#D4D4D4;">│   └── ddb_crd.yaml                </span><span style="color:#6A9955;"># dolphindb的crd资源</span></span>
<span class="line"><span style="color:#D4D4D4;">├── templates                   </span><span style="color:#6A9955;"># Kubernetes资源定义所在路径</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── _helpers.tpl                </span><span style="color:#6A9955;"># 模板变量处理</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── envconfig.yaml              </span><span style="color:#6A9955;"># 配置管理，DolphinDB MGR的环境配置，表现为configmap资源</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── license.yaml                </span><span style="color:#6A9955;"># DolphinDB运行时需要的license, 表现为configmap资源</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── promtail-config.yaml        </span><span style="color:#6A9955;"># 使用promtail进行日志采集时需要的配置，表现为configmap资源</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── role.yaml                   </span><span style="color:#6A9955;"># 权限管理，规定DolphinDB MGR内部组件的Kubernetes权限,表现为role或clusterrole资源</span></span>
<span class="line"><span style="color:#D4D4D4;">│   ├── rolebinding.yaml            </span><span style="color:#6A9955;"># 权限管理，结合role使用,表现为rolebinding或clusterrolebinding资源</span></span>
<span class="line"><span style="color:#D4D4D4;">│   └── serviceaccount.yaml         </span><span style="color:#6A9955;"># 权限管理，结合role、rolebinding使用,直接与微服务组件的pod绑定</span></span>
<span class="line"><span style="color:#D4D4D4;">└── values.yaml</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="在线安装" tabindex="-1"><a class="header-anchor" href="#在线安装" aria-hidden="true">#</a> 在线安装</h3><ul><li><strong>步骤1</strong>: # 添加<code>Helm仓库</code></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">helm repo add dolphindb https://dolphindbit.github.io/helm-chart/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>步骤2</strong>: 安装 <code>DolphinDB MGR</code></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">helm install </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 安装DolphinDB MGR</span></span>
<span class="line"><span style="color:#D4D4D4;">  dolphindb-mgr </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                            </span><span style="color:#6A9955;"># 名称为&#39;dolphindb-mgr&#39;</span></span>
<span class="line"><span style="color:#D4D4D4;">  dolphindb/dolphindb-mgr </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                  </span><span style="color:#6A9955;"># 使用名为&#39;dolphindb’的helm仓库中名为&#39;dolphindb-mgr&#39;的chart包</span></span>
<span class="line"><span style="color:#D4D4D4;">  --set-file license.content=</span><span style="color:#9CDCFE;">$licensePath</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">  </span><span style="color:#6A9955;"># 使用\`$licensePath\`指向的文件作为dolphindb的license</span></span>
<span class="line"><span style="color:#D4D4D4;">  -ndolphindb --create-namespace              </span><span style="color:#6A9955;"># 安装在&#39;dolphindb&#39;这个namespace中，如果该namespace不存在，则自动创建</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>部署参数可参考<a href="#%E9%83%A8%E7%BD%B2%E5%8F%82%E6%95%B0">Chart参数</a>；</p></div><h3 id="离线安装" tabindex="-1"><a class="header-anchor" href="#离线安装" aria-hidden="true">#</a> 离线安装</h3><ul><li><p><strong>步骤1</strong>: 获取<code>Chart包</code>至当前路径</p><ul><li>方式一：从<code>Helm仓库</code>下载(需先添加<code>Helm仓库</code>，添加方式参考<a href="#%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85">在线安装</a>)</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">helm pull dolphindb/dolphindb-mgr</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>方式二：从别处下载或拷贝至当前路径。</li></ul></li><li><p><strong>步骤2</strong>: 安装 <code>DolphinDB MGR</code></p></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">helm install </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 安装DolphinDB MGR</span></span>
<span class="line"><span style="color:#D4D4D4;">  dolphindb-mgr </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                            </span><span style="color:#6A9955;"># 名称为&#39;dolphindb-mgr&#39;</span></span>
<span class="line"><span style="color:#D4D4D4;">  dolphindb-mgr </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                            </span><span style="color:#6A9955;"># 使用当前路径中名为&#39;dolphindb-mgr&#39;的chart包</span></span>
<span class="line"><span style="color:#D4D4D4;">  --set-file license.content=</span><span style="color:#9CDCFE;">$licensePath</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">  </span><span style="color:#6A9955;"># 使用\`$licensePath\`指向的文件作为dolphindb的license</span></span>
<span class="line"><span style="color:#D4D4D4;">  -ndolphindb --create-namespace              </span><span style="color:#6A9955;"># 安装在&#39;dolphindb&#39;这个namespace中，如果该namespace不存在，则自动创建</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><p>部署参数可参考<a href="#%E9%83%A8%E7%BD%B2%E5%8F%82%E6%95%B0">Chart参数</a>；</p></div><h3 id="升级指引" tabindex="-1"><a class="header-anchor" href="#升级指引" aria-hidden="true">#</a> 升级指引</h3><p>如果需要对已部署的<code>Chart包</code>进行原地升级，则可以将安装步骤中的<code>install</code>子命令替换为<code>upgrade</code>子命令即可(在线安装或离线安装均可)：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">安装：helm install ……</span></span>
<span class="line"><span style="color:#D4D4D4;">升级：helm upgrade …… (安装时添加的部署参数不再生效，在此需要重新添加部署参数)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">提示</p><ul><li>离线安装的<code>Chart包</code>可以在线升级，在线安装的<code>Chart包</code>也可以离线升级。</li><li>由于浏览器缓存缓存，可视化界面在升级之后可能需要清理浏览器缓存方可生效。</li></ul></div><h3 id="部署参数" tabindex="-1"><a class="header-anchor" href="#部署参数" aria-hidden="true">#</a> 部署参数</h3><p>使用<code>Helm工具</code>部署<code>Chart包</code>，部署参数包括：</p><ul><li><a href="#helm%E5%8F%82%E6%95%B0">Helm参数</a>：Helm部署指令自带的参数;</li><li><a href="#chart%E5%8C%85%E5%8F%82%E6%95%B0">Chart包参数</a>：<code>Chart包</code>根路径下的<code>values.yaml</code>文件定义的参数。</li></ul><p>可根据所在Kubernetes环境指定部署参数，详情可参考<a href="#%E9%83%A8%E7%BD%B2%E5%8F%82%E6%95%B0%E7%A4%BA%E4%BE%8B">部署参数示例</a></p><h4 id="helm参数" tabindex="-1"><a class="header-anchor" href="#helm参数" aria-hidden="true">#</a> Helm参数</h4><p>可使用如下指令查看Helm部署指令自带的参数：</p><ul><li><code>helm install -h</code></li><li><code>helm upgrade -h</code></li></ul><p>常用的Helm部署指令自带参数如下：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">--set               指定chart包内部的参数，使用方式为 --set </span><span style="color:#9CDCFE;">$chartParameterKey</span><span style="color:#D4D4D4;">=</span><span style="color:#9CDCFE;">$value</span></span>
<span class="line"><span style="color:#D4D4D4;">--set-file          指定chart包内部的参数从本地文件中读取,使用方式为 --set-file </span><span style="color:#9CDCFE;">$chartParameterKey</span><span style="color:#D4D4D4;">=</span><span style="color:#9CDCFE;">$localFilePath</span></span>
<span class="line"><span style="color:#D4D4D4;">--version           指定安装/升级所用到的Chart包版本，默认指定正式发布的最新版本(在线安装)或者本地Chart包版本(离线安装)</span></span>
<span class="line"><span style="color:#D4D4D4;">--namespace, -n     指定部署的namespace，默认是在名为‘default’的namespace</span></span>
<span class="line"><span style="color:#D4D4D4;">--create-namespace  若指定部署的namespace不存在，则创建该namespace</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="chart包参数" tabindex="-1"><a class="header-anchor" href="#chart包参数" aria-hidden="true">#</a> Chart包参数</h4><p><code>Chart包</code>参数是指<code>Chart包</code>根路径下的<code>values.yaml</code>文件定义的参数。</p><p><code>dolphindb-mgr/values.yaml</code>文件定义的参数主要如下：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#6A9955;">####################################################################################################</span></span>
<span class="line"><span style="color:#6A9955;">##                                            全局配置                                             ##</span></span>
<span class="line"><span style="color:#6A9955;">####################################################################################################</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">global</span><span style="color:#D4D4D4;">:                                   </span><span style="color:#6A9955;"># 全局参数，chart包及子Chart包均可使用</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">registry</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                                </span><span style="color:#6A9955;"># 镜像仓库所在地址，默认为空，表示dockerhub</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">repository</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">dolphindb</span><span style="color:#D4D4D4;">                       </span><span style="color:#6A9955;"># 镜像仓库名称</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">storageClass</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                            </span><span style="color:#6A9955;"># 存储类，用于PVC和PV分配，默认为空，表示使用默认存储类</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">serviceType</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">NodePort</span><span style="color:#D4D4D4;">                       </span><span style="color:#6A9955;"># 服务访问类型，与Kubernetes环境的网络策略有关，默认为NodePort</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">allNamespace</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">false</span><span style="color:#D4D4D4;">                         </span><span style="color:#6A9955;"># 判断是否监听所有namespace下的DolphinDB资源，默认为false,表示只管理DolphinDB MGR所在的namespace中的DolphinDB相关资源。</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">localTimeFileHostPath</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;/etc/localtime&quot;</span><span style="color:#D4D4D4;">     </span><span style="color:#6A9955;"># 宿主机时区文件路径，用于保持容器内时钟与环境时钟一致，需保持与宿主机上的时区文件路径一致，默认为&quot;/etc/localtime&quot;</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">customDomainSuffix</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                      </span><span style="color:#6A9955;"># 自定义域名后缀，默认为空，表示使用Kubernetes原生域名后缀&#39;svc.cluster.local&#39;; 若Kubernetes环境的DNS配置了集群内部的服务域名后缀(记为$domainSuffix),则此处应配置为$domainSuffix</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">nodeAffinity</span><span style="color:#D4D4D4;">:                               </span><span style="color:#6A9955;"># 节点亲和性，可指定DolphinDB MGR和DolphinDB所有的Pod运行的node宿主机。默认指定为标记了‘dolphindb.io/pod: dolphindb’标签的node节点</span></span>
<span class="line"><span style="color:#CE9178;">……</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">existingLokiAddress</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                     </span><span style="color:#6A9955;"># 已存在的loki服务的地址，默认为空，表示使用DolphinDB MGR内置的Loki服务作为日志存储；若配置了此参数，则将使用配置的地址作为Loki日志存储服务</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">minPersistentVolumeSize</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                 </span><span style="color:#6A9955;"># 持久卷最小空间，默认为空，表示不限制持久卷最小空间。主要用于公有云平台中对持久卷空间有最小限制的Kubernetes环境，</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">####################################################################################################</span></span>
<span class="line"><span style="color:#6A9955;">##                                         DolphinDB配置                                           ##</span></span>
<span class="line"><span style="color:#6A9955;">####################################################################################################</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">dolphindb</span><span style="color:#D4D4D4;">:                                </span><span style="color:#6A9955;"># DolphinDB基本配置，在全局配置的基础上进行覆盖，不配置的字段会默认使用全局配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">serviceType</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                             </span><span style="color:#6A9955;"># 同 global.serviceType</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">coreDumpDir</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;/data/ddb/core&quot;</span><span style="color:#D4D4D4;">               </span><span style="color:#6A9955;"># core dump文件路径，在DolphinDB进程触发core dump时，相应的core dump文件生成路径</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">controllerDataSize</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">200Mi</span><span style="color:#D4D4D4;">                   </span><span style="color:#6A9955;"># DolphinDB的controller实例的数据需要持久卷的空间</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">datanodeDataSize</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">200Mi</span><span style="color:#D4D4D4;">                     </span><span style="color:#6A9955;"># DolphinDB的datanode实例的数据需要持久卷的空间</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">disableExporter</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">false</span><span style="color:#D4D4D4;">                      </span><span style="color:#6A9955;"># 是否禁用dolphindb-exporter组件，默认false,表示使用dolphindb-exporter来采集DolphinDB指标信息，以便于汇总到Prometheus服务</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">logCleanLimit</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">0.9</span><span style="color:#D4D4D4;">                          </span><span style="color:#6A9955;"># 日志清理阈值，默认为0.9,表示当DolphinDB所在容器的日志文件大小达到日志的PVC定义的存储空间的90%时，开始清理该容器中的历史日志文件</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">images</span><span style="color:#D4D4D4;">:                                     </span><span style="color:#6A9955;"># 镜像名称和tag，主要用于配置对容器命名有特殊要求的云平台进行容器的重命名，以及开发人员或运维人员对相关镜像的调试或问题定位</span></span>
<span class="line"><span style="color:#CE9178;">……</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">license</span><span style="color:#D4D4D4;">:                                  </span><span style="color:#6A9955;"># DolphinDB License的相关配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">content</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                                 </span><span style="color:#6A9955;"># DolphinDB License内容，用于DolphinDB运行时的身份鉴权</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">resources</span><span style="color:#D4D4D4;">:                                  </span><span style="color:#6A9955;"># DolphinDB License指定的资源配置，主要用于可视化界面上DolphinDB的默认资源配置</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">limits</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">cpu</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">1</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">memory</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">1Gi</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">requests</span><span style="color:#D4D4D4;">:</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">cpu</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">1</span></span>
<span class="line"><span style="color:#D4D4D4;">      </span><span style="color:#569CD6;">memory</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">1Gi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">####################################################################################################</span></span>
<span class="line"><span style="color:#6A9955;">##                                          服务组件配置                                            ##</span></span>
<span class="line"><span style="color:#6A9955;">####################################################################################################</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">dolphindb-operator</span><span style="color:#D4D4D4;">:                       </span><span style="color:#6A9955;"># DolphinDB Operator组件的相关配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">enabled</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 是否部署DolphinDB Operator组件，默认为true</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">replicaCount</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">                             </span><span style="color:#6A9955;"># 副本数，表示DolphinDB Operator运行的Pod个数，默认为2，一主一备</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">dolphindb-cloud-portal</span><span style="color:#D4D4D4;">:                   </span><span style="color:#6A9955;"># DolphinDB Cloud Portal组件的相关配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">enabled</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 是否部署DolphinDB Cloud Portal组件，默认为true</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">replicaCount</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">                             </span><span style="color:#6A9955;"># 副本数，表示DolphinDB Cloud Portal运行的Pod个数，默认为2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">dolphindb-webserver</span><span style="color:#D4D4D4;">:                      </span><span style="color:#6A9955;"># DolphinDB Webserver组件的相关配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">enabled</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 是否部署DolphinDB Webserver组件，默认为true</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">replicaCount</span><span style="color:#D4D4D4;">: </span><span style="color:#B5CEA8;">2</span><span style="color:#D4D4D4;">                             </span><span style="color:#6A9955;"># 副本数，表示DolphinDB Webserver运行的Pod个数，默认为2</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">nodePortIP</span><span style="color:#D4D4D4;">: </span><span style="color:#CE9178;">&quot;&quot;</span><span style="color:#D4D4D4;">                              </span><span style="color:#6A9955;"># 访问节点的IP,如果serviceType是NodePort，则需要提供Kubernetes中任意一台节点IP作为服务节点IP,主要用于可视化界面展示，便于页面直接跳转到DolphinDB自带的操作界面</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">grafana</span><span style="color:#D4D4D4;">:                                  </span><span style="color:#6A9955;"># Grafana组件的相关配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">enabled</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 是否部署Grafana组件，默认为true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">prometheus</span><span style="color:#D4D4D4;">:                               </span><span style="color:#6A9955;"># Prometheus组件的相关配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">enabled</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 是否部署Prometheus组件，默认为true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">alertmanager</span><span style="color:#D4D4D4;">:                             </span><span style="color:#6A9955;"># Alertmanager组件的相关配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">enabled</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 是否部署Alertmanager组件，默认为true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">node-exporter</span><span style="color:#D4D4D4;">:                            </span><span style="color:#6A9955;"># Node Exporter组件的相关配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">enabled</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 是否部署Node Exporter组件，默认为true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">loki</span><span style="color:#D4D4D4;">:                                     </span><span style="color:#6A9955;"># Loki组件的相关配置</span></span>
<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#569CD6;">enabled</span><span style="color:#D4D4D4;">: </span><span style="color:#569CD6;">true</span><span style="color:#D4D4D4;">                               </span><span style="color:#6A9955;"># 是否部署Loki组件，默认为true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="部署参数示例" tabindex="-1"><a class="header-anchor" href="#部署参数示例" aria-hidden="true">#</a> 部署参数示例</h4><p>部署参数配置可参考以下示例：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">helm install </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                                 </span></span>
<span class="line"><span style="color:#D4D4D4;">  dolphindb-mgr </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                                      </span><span style="color:#6A9955;"># 名称为&#39;dolphindb-mgr&#39;</span></span>
<span class="line"><span style="color:#D4D4D4;">  dolphindb/dolphindb-mgr </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">                            </span><span style="color:#6A9955;"># 使用名为&#39;dolphindb’的helm仓库中名为&#39;dolphindb-mgr&#39;的chart包</span></span>
<span class="line"><span style="color:#D4D4D4;">  --set global.registry=</span><span style="color:#CE9178;">&#39;192.168.1.240&#39;</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">              </span><span style="color:#6A9955;"># 镜像从私有容器仓库获取，地址为&#39;192.168.1.240&#39;</span></span>
<span class="line"><span style="color:#D4D4D4;">  --set dolphindb-webserver.nodePortIP=</span><span style="color:#CE9178;">&#39;192.168.1.99&#39;</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\ </span><span style="color:#6A9955;"># 当前集群中选择一台机器IP地址为&#39;192.168.1.99&#39;作为可视化界面上访问DolphinDB的入口(仅在服务类型为&#39;NodePort&#39;时生效)</span></span>
<span class="line"><span style="color:#D4D4D4;">  --set-file license.content=</span><span style="color:#CE9178;">&#39;/data/dolphindb.lic&#39;</span><span style="color:#D4D4D4;"> </span><span style="color:#D7BA7D;">\\ </span><span style="color:#D4D4D4;">   </span><span style="color:#6A9955;"># DolphinDB License文件路径为&#39;/data/dolphindb.lic&#39;</span></span>
<span class="line"><span style="color:#D4D4D4;">  -ndolphindb --create-namespace                        </span><span style="color:#6A9955;"># 安装在&#39;dolphindb&#39;这个namespace中，如果该namespace不存在，则自动创建</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,35),B=n("h2",{id:"完成部署",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#完成部署","aria-hidden":"true"},"#"),s(" 完成部署")],-1),g=n("code",null,"Pod",-1);function f(k,_){const p=r("ExternalLinkIcon"),l=r("RouterLink");return i(),t("div",null,[D(` ---
sidebarDepth: 3
--- `),y,n("ul",null,[n("li",null,[n("a",h,[s("Kubernetes v1.18.0+"),a(p)]),s(": 可参考"),a(l,{to:"/zh/reference/kubernetes/installer-config.html"},{default:e(()=>[s("Kubernetes环境搭建")]),_:1})]),n("li",null,[n("a",u,[s("Docker 20.10.10+"),a(p)]),s(": 可参考"),a(l,{to:"/zh/reference/tools/docker.html"},{default:e(()=>[s("Docker环境搭建")]),_:1})])]),v,m,n("p",null,[n("a",b,[s("获取DolphinDB License"),a(p)]),s("并保存至本地。")]),C,n("p",null,[s("DolphinDB MGR的完整功能封装在"),A,s("中，可使用"),a(l,{to:"/zh/tutorial/reference/tools/helm.html"},{default:e(()=>[s("Helm工具")]),_:1}),s("参考如下方式快速安装：")]),E,n("p",null,[s("可更多细节配置可参考"),a(l,{to:"/zh/tutorial/kubernetes/dolphindb-mgr/faq.html#chart%E5%8C%85%E9%83%A8%E7%BD%B2%E5%8F%82%E6%95%B0%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE"},{default:e(()=>[s("FAQ-Chart包部署参数如何配置...")]),_:1})]),B,n("p",null,[s("部署好DolphinDB MGR，等待所有"),g,s("均已就绪，便可通过"),a(l,{to:"/zh/tutorial/kubernetes/dolphindb-mgr/portal.html"},{default:e(()=>[s("可视化界面")]),_:1}),s("管理DolphinDB相关资源。")])])}const P=c(d,[["render",f],["__file","deployment.html.vue"]]);export{P as default};
